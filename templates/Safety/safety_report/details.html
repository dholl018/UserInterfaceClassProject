{% extends "Safety/base.html" %}
{% load static %}
{% load humanize %}
{% block content %}
    <div id="center-div">
        <div class="single-report" data-mod-locked="{{ report.mod_Locked }}">
                <div id="locked" class="hide">
                    <p class="locked-post" data-mod-locked="{{ report.mod_Locked }}">{{ report.title }} post has been locked for commenting by the Moderators</p>
                </div>
            <h3>Title:</h3>
            <p class="Report-Title">{{ report.title }}</p>
            <h3>Submitter:</h3>
            <p class="person-submit">{{ report.author }}</p>
            <h3>Location:</h3>
            <p class="person-submit">{{ report.location }}</p>
            <h3>Date:</h3>
            <p class ="date-submit">{{ report.date_posted }}</p>
            <h3>Report:</h3>
            <p class="report-submit">{{ report.description }}</p>
            <div>
                {% if request.session.role == 'admin' %}
                     <form id="post-tools" action="{% url 'Safety:delete_report' report.id %}" method="POST">
                        {% csrf_token %}
                        <h2>Moderation Tools</h2>
                        <input type="submit" class="Dislike"  value="Delete Post" id="delete-post">
                     </form>
                        <button type="button" id="lock-post" class="Dislike" data-report-id="{{ report.id }}" data-ajax-url="{% url "Safety:locked-post" %}" data-mod-locked="{{ report.mod_Locked }}">Lock Post</button>
                {% elif request.session.username == report.author %}
                    <form id="post-tools" action="{% url 'Safety:edit_report' report.id %}" method="get">
                        <h2>Edit Post</h2>
                        <input type="submit" class="Likes" value="Edit" id="edit">
                {% endif %}
                    </form>
            </div>
        </div><!--single report-->

    </div>
        <div class="Comments-Section" id="section">
        <h3 class="commentHeader">Comments</h3>
            {% for comment in report.comments.all.reverse %}
                <div id= "postedComment" class="comment">
                    <p class="commentAuthor">
                        <a href="{% url 'users:profile' comment.author %}">{{ comment.author }}</a> posted {{ comment.date_posted|naturalday }}
                    </p>
                    {{ comment.comment|linebreaks }}
                </div>
                {% if comment.author == request.session.username or request.session.role == 'admin' %}
                        <button id="editCommentButton" data-comment-id="{{ comment.id }}" class="CommentButton">Edit Comment</button>
                    <form method="post" action="{% url 'safety:delete-comment' report.id comment.id %}">
                        {% csrf_token %}
                        <input type="submit" id="deleteComment" class="CommentButton" value="Delete Comment">
                    </form>

                {% endif %}
                <form id="editcommentForm" class="hide" action="{% url 'safety:edit-comment' report.id comment.id %}" method="POST">
                    {% csrf_token %}
                    <textarea name="editCommentbox">{{ comment.comment }}</textarea>
                    <input type="submit" value="edit" id="edit-submit-comment">
                </form>
            {% empty %}
                <p>No comments have been posted yet.</p>
            {% endfor %}
            <h3 class="commentHeader">New Comment</h3>
            <button class="Likes" id="like-button" data-report-id="{{ report.id }}" data-ajax-url="{% url "Safety:like-post" %}">Like Post &#x25B2;</button>
            <button class="Dislike">Dislike Post &#x25BC;</button>
        <form id="new-comment-post" action="{% url 'safety:post-comment' report.id %}" method="POST">
            {% csrf_token %}
            <textarea placeholder="Add Your Comment" id="user-Comment" name="newComment"></textarea>
            <input type="submit" value="comment" id="submit-comment">
        </form>

    </div> <!--comment-->

{% endblock %}